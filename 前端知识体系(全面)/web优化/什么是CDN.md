### CDN
CDN(Content Delivery Network)，由分布在不同区域的边缘节点服务器群组成的分布式网络。CDN的工作原理就是将源站的资源缓存到位于全国各地的CDN节点上，
用户请求资源时，就近返回边缘节点上缓存的资源，而不需要每个用户的请求都回源站获取，避免网络拥塞、分担源站压力，保证用户访问资源的速度和体验


我们上线一个网站的过程肯定是，买一台服务器，将我们的html，css，js上传到服务器，然后购买域名，配置域名对应的服务器IP地址。如果不使用CDN，然后
我们的服务器在广州，那么在黑龙江或者新疆这些离服务器很远的地方，访问速度就很慢。而且只有一台服务器的情况下，如果大量的用户访问，就会造成网络阻塞。


当給一个域名开通了CDN，要先给域名的DNS解析设置的后台添加一条CDN专用的解析记录，这条解析记录会让
域名被解析之后，指向一个CDN网络专用的处理DNS请求的服务器，这个专门的CDN网络的DNS服务器会给你的浏览器返回一台专门用来
给各个请求设备分配合适的CDN服务器的这样一种服务器的IP地址，这种服务器叫做负载均衡系统服务器，然后浏览器会去访问这台负载均衡
系统服务器，负载均衡系统服务器会根据你浏览器的网络地址，会在CDN网络中找一台在各种条件下都比较适合给你的边缘节点服务器，然后
将边缘节点服务器的IP地址返回给浏览器，然后浏览器会向边缘节点服务器请求网站的资源


在使用内容分发网络时，需要使用CNAME将源站域名指向CDN服务商指定的域名，而后者的解析由CDN服务商的DNS服务器负责。
于是源站域名的最终解析权就交到了CDN服务商提供的DNS服务器手中。CDN服务商的DNS服务器并不会简单地给出一个固定的IP地址，
而是会根据用户请求的源IP等信息，寻找出一个距离当前用户最近的CDN节点的IP后返回给用户。这样，用户解析源站的域名，拿到的却是CDN节点的地址。


### CDN访问原理或者说过程
假设业务源站域名为:www.test.com，域名接入 CDN 开始使用加速服务后，当用户发起 HTTP 请求时，实际的处理流程如下所示：
- 用户向www.test.com 下的某图片资源（如：1.jpg）发起请求，会先向 Local DNS 发起域名解析请求。
- 当 Local DNS 解析www.test.com时，发现已经配置了 CNAME www.test.com.cdn.dnsv1.com，解析请求会发送至腾讯云或者阿里云等CDN服务提供商，其实
就是专门的CDN网络负载均衡系统服务器，域名解析就交给了阿里云或者腾讯云，会为请求分配最佳CDN节点 IP。
- Local DNS 获取 Tencent DNS 返回的解析 IP，该IP对应的是一个边缘CDN服务器，并返回給浏览器。
- 浏览器向获取的 IP 发起对资源 1.jpg 的访问请求。
- 若IP对应的CDN服务器节点缓存有 1.jpg，则会将数据直接返回给用户，此时请求结束。
若该节点未缓存 1.jpg，则节点会向业务源站发起对 1.jpg 的请求，获取资源后，结合用户自定义配置的缓存策略，将资源缓存至节点，并返回给用户，
此时请求结束。

### CDN的优势
CDN从技术上全面解决了由于网络带宽小，用户访问量打，网点分布不均等问题，提高用户访问网站的响应速度
- 跨运营商、跨地域的全网覆盖
- 保障源站的安全。CDN的负载均衡和分布式存储技术，可以加强网站的可靠性。
- 异地备援。
- 节约成本投入。不用考虑购买服务器与后续的托管运维，服务器之间镜像同步。


### 关于CDN的一些术语
- CNAME记录。它是一个别名记录(Canonical Name)，当 DNS 系统在查询 CNAME 左面的名称的时候，都会转向 CNAME 右面的名称再进行查询，
一直追踪到最后的 PTR 或 A 名称，成功查询后才会做出回应，否则失败

- CNAME域名。CDN的域名加速需要用到CNAME记录，在阿里云控制台配置完成CDN加速后，您会得到一个加速后的域名，
称之为CNAME域名（该域名一定是.http://kunlun.com）， 用户需要将自己的域名作CNAME指向这个.http://kunlun.com的域名后，
域名解析的工作就正式转向阿里云，该域名所有的请求都将转向阿里云CDN的节点。

- 边缘节点。通俗点理解就是指离用户最近的CDN服务器。


### CND的使用场景
- 网站站点/应用加速
- 音视频点播/大文件下载分发加速
- 视频直播加速
- 移动应用加速

### CDN加速服务使用限制
- 账号需在阿里云官网完成账号实名认证
- 加速的域名必须在工信部完成备案，并接入阿里云
- 加速域名的源站内容，需保存于ECS或者OSS；如源站内容不在阿里云，接入需经过审核


### 添加CDN加速域名
添加加速域名如下图：可以看出，testcdn.cdnpe.com就是资源对应的cdn域名，该域名可以关联源站的域名或者IP地址。
这里需要注意的是，启用CDN加速服务需要将源站域名指向加速域名，再由加速域名提供IP地址，需要在DNS服务商处为域名添加CNAME记录，
从而达到内容分发加速的效果


![image](https://github.com/lizuncong/Front-End-Development-Notes/blob/master/resource/alicdn.jpg)
